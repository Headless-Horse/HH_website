<!DOCTYPE html>
<html>

</html>

<style>
body {
  margin: 0;
  -ms-overflow-style: none;
  scrollbar-width: none;
}

#pinterest {
  display: grid;
  align-content: center;
  justify-content: center;
  margin: 0;
  padding: 100px;
  list-style: none;
  grid-template-columns: repeat(3, 1fr);
  grid-auto-rows: 30vh;
  grid-gap: 200px;
}

#pinterest>li {
  background-position: center;
  background-size: contain;
  background-repeat: no-repeat;
  filter: grayscale(50%) contrast(0.8) brightness(0.9);
}

@media screen and (max-width: 1000px) {
  #pinterest {
    grid-template-columns: repeat(1, 1fr);
    grid-gap: 100px;
  }
}
</style>

<script>
class PinterestFeed {
  constructor(...slug) {
    this.feed = [];
    this.getFeeds(slug);
  }

  reflect(promise) {
    return promise.then(v => v.pins).catch(e => e);
  }

  getFeed(slug) {
    const api = `https://widgets.pinterest.com/v3/pidgets/boards/${slug}/pins/`;
    return new Promise((resolve, reject) => {
      const xhr = new XMLHttpRequest();
      xhr.open('GET', api);
      xhr.onload = function () {
        if (xhr.status === 200) {
          const response = JSON.parse(xhr.responseText);
          resolve(response.data);
        } else {
          reject(Error(xhr.statusText));
        }
      };
      xhr.onerror = function () {
        reject(Error('Network Error'));
      };
      xhr.send();
    });
  }

  getFeeds(...slug) {
    return Promise.all(slug.map(v => this.reflect(this.getFeed(v))));
  }
}

const container = document.createElement('div');
container.id = 'pinterest';
document.body.appendChild(container);

const list = document.querySelector('#pinterest');
const boards = [
  'headless_horse/direction',
  'headless_horse/wellness',
  'headless_horse/fashion',
  'headless_horse/space',
  'headless_horse/print'
];
const feed = new PinterestFeed(...boards);
let feedItems = [];

feed.getFeeds(...boards)
  .then(response => {
    feedItems = response.flat();
    feedItems.forEach(item => {
      const imageUrl = item.images['237x'].url;
      const li = document.createElement('li');
      li.style.backgroundImage = `url(${imageUrl})`;
      list.appendChild(li);
    });

    function htmlShuffle(elem) {
      function shuffle(arr) {
        var len = arr.length;
        var d = len;
        var array = [];
        var k, i;
        for (i = 0; i < d; i++) {
          k = Math.floor(Math.random() * len);
          array.push(arr[k]);
          arr.splice(k, 1);
          len = arr.length;
        }
        for (i = 0; i < d; i++) {
          arr[i] = array[i];
        }
        return arr;
      }

      var el = document.querySelectorAll('#pinterest > li');
      let pos = Array.from({ length: el.length }, (_, i) => i);
      pos = shuffle(pos);
      pos.forEach(i => document.querySelector(elem).appendChild(el[i]));
    }

    htmlShuffle('#pinterest');
  })
  .catch(error => console.log(error));
</script>