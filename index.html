<!DOCTYPE html>
<html lang="en">

<body style="background-color: #000000;">
  <div id="loader">
    <div id="loader_percentage"></div>
    <div id="loader_frame">
      <div id="loader_trackbar">
        <div id="loader_bar"></div>
      </div>
    </div>
  </div>

  <ul id="nav_bottom">
    <li class="nav_link click_sound" title="Headless Horse"><a>●</a></li>
    <li><span id="notice_list" class="click_sound"></span></li>
    <li style="float: right"><span id="clock" data-tz="Europe/London"></span></li>
  </ul>

  <div id="terminal">
    <div id="terminal_container">
      <a id="terminal_close" class="terminal_close click_sound" onclick="clearframe(); pauseAudio()"></a>
      <button id="terminal_button"><a>●</a></button>
      <div id="terminal_title">Headless Horse</div>
      <iframe id="terminal_iframe" name="terminal_iframe" src="" frameborder="0"></iframe>
      <div id="terminal_content_frame">
        <div id=terminal_content>

          <section id="home">
            <p>Welcome <span id="welcome_back"></span>to Headless Horse.</p>
            <p id="lastvisit_message"></p>
            <p id="hours_list"></p>
            <br>
            <p id="firstuse_message"></p>
          </section>

          <section id="info">
            <p id="info_list"></p>
          </section>

          <section id="projects">
            <p>CASE STUDIES</p>
            <p id="project_list"></p>
          </section>

          <section id="contact">
            <p id="contact_list"></p>
          </section>

          <section id="shop">
            <p>Loading...</p>
          </section>

          <section id="lab">
            <p>LAB</p>
            <p>A home for ideas, experiments and abandoned projects.</p>
            <p id="lab_list"></p>
          </section>

          <section id="follow">
            <p>FOLLOW</p>
            <p id="follow_list"></p>
          </section>

          <section id="press">
            <p>SELECTED FEATURES</p>
            <p id="press_list"></p>
          </section>

          <section id="mailinglist">
            <p>MAILINGLIST</p>
            <p>Join our mailing list to be the first to receive updates on project launches, product releases and news.</p>
            <p id="validate_message"></p>
          </section>

          <section id="login">
            <p>Please enter your password below.</p>
          </section>

          <section id="jobs">
            <p>JOBS</p>
            <p id="job_list"></p>
          </section>

          <section id="imprint">
            <p id="imprint_list"></p>
          </section>

          <section id="tweet">
            <p>Loading...</p>
          </section>

          <section id="like">
            <p>Loading...</p>
          </section>

          <section id="email">
            <p>Loading...</p>
          </section>

          <section id="list">
            <pre>
headless.horse/
├── SITE/
│   ├── info
│   ├── projects
│   └── contact
├── PUBLIC/
│   ├── follow
│   ├── press
│   ├── shop
│   ├── lab
│   └── mailinglist
├── PRIVATE/
│   └── login
├── OTHER/
│   ├── jobs
│   └── imprint
└── SHARE/
    ├── tweet
    ├── like
    └── email
          </pre>
          </section>

          <section id="error">
            <p>Error. Command not recognised.</p>
            <br>
            <p>Type 'list' to see a list of commands.</p>
          </section>

          <p id="command">root@hhorse:~# <input id="commandinput" type="text" autofocus autocorrect="off" autocomplete="off" autocapitalize="off" onkeyup="this.value = this.value.toLowerCase();"></p>
        </div>
      </div>
    </div>
  </div>

  <div id="img_cover" onclick="clearframe()"></div>

  <img id="img" src="http://assets.headless.horse/images/wall_2020.jpg" width="4995" height="3958" draggable="false" oncontextmenu="return false;" usemap="#img-map" />
  <map name="img-map">
    <!--[20] Renderboxes: Identity-->
    <area href="/project-20/" class="project_link" onmouseenter="playMouseIn()" target="terminal_iframe" Title="Renderboxes: Identity" shape="poly"
      coords="1410,1197,1424,1077,1641,1063,1636,960,1612,959,1625,643,1674,645,1675,626,1536,619,1309,628,1307,612,1289,612,1289,598,1162,600,1149,462,994,472,1004,601,998,602,994,569,767,576,775,770,764,955,927,960,924,1125,1011,1127,1302,1134,1298,1186">
    <!--[19] Jordan Brand: Air Jordan 1-->
    <area href="/project-19/" class="project_link" onmouseenter="playMouseIn()" target="terminal_iframe" title="Jordan Brand: Air Jordan 1" shape="poly"
      coords="3168,1033,2902,1029,2901,1276,2943,1278,2936,1372,3073,1373,3073,1306,3113,1302,3107,1204,3165,1200">
    <!--[19] Jordan Brand: Air Jordan 1-->
    <area href="/project-19/" class="project_link" onmouseenter="playMouseIn()" target="terminal_iframe" title="Jordan Brand: Air Jordan 1" shape="poly"
      coords="3566,954,3391,961,3389,1238,3359,1236,3329,1578,3624,1602,3628,1556,3574,1555,3585,1218,3727,1223,3728,1102,3713,1102,3713,1007,3566,1003">
    <!--[18] Nike: Cortez, Blue Ribbon Sports-->
    <area href="/project-18/" class="project_link" onmouseenter="playMouseIn()" target="terminal_iframe" title="Nike: Cortez, Blue Ribbon Sports" shape="poly"
      coords="3012,1807,2812,1798,2810,1833,2767,1833,2766,1555,2920,1566,2934,1403,3053,1404,3051,1536,3074,1540,3074,1625,3270,1627,3269,1859,3281,1859,3275,2005,3006,1957">
    <!--[17] Nike: Studio of Dreams-->
    <area href="/project-17/" class="project_link" onmouseenter="playMouseIn()" target="terminal_iframe" title="Nike: Studio of Dreams" shape="poly"
      coords="3340,430,3013,430,3013,450,3022,449,3024,641,3012,641,3011,727,3012,736,2991,737,2990,801,2894,802,2910,1009,2887,1010,2888,1029,3348,1033,3355,1014,3357,737,3334,736">
    <!--[17] Nike: Studio of Dreams-->
    <area href="/project-17/" class="project_link" onmouseenter="playMouseIn()" target="terminal_iframe" title="Nike: Studio of Dreams" shape="poly"
      coords="1470,3009,1440,2994,1448,2957,1537,2903,1655,2842,1668,2840,1686,2855,1706,2866,1733,2864,1757,2850,1780,2839,1791,2841,1798,2855,1797,2870,1836,2850,1853,2850,1863,2851,1872,2884,1880,2906,1880,2930,1879,2957,1879,2970,1859,2982,1855,2993,1808,2998,1780,2998,1764,2995,1752,2996,1730,3005,1721,3010,1722,3016,1721,3021,1697,3024,1663,3026,1639,3026,1615,3025,1567,3024,1542,3021,1510,3018,1486,3013">
    <!--[16] Karl Lagerfeld: In Memoriam-->
    <area href="/project-16/" class="project_link" onmouseenter="playMouseIn()" target="terminal_iframe" title="Karl Lagerfeld: In Memoriam" shape="poly"
      coords="2203,479,2204,537,2216,536,2228,728,2105,736,2106,824,2137,824,2136,1009,2327,1006,2327,1165,2652,1170,2656,856,2683,855,2699,827,2694,468,2358,469,2359,478">
    <!--[15] LYMA: Super Supplement-->
    <area href="/project-15/" class="project_link" onmouseenter="playMouseIn()" target="terminal_iframe" title="LYMA: Super Supplement" shape="poly"
      coords="2169,1014,2137,1013,2136,1019,1798,1020,1797,969,1637,959,1643,1066,1507,1072,1498,1181,1415,1183,1413,1199,1281,1186,1280,1394,1381,1400,1370,1650,1426,1650,1420,1781,1572,1781,1572,1792,1419,1814,1516,1813,1520,2044,1426,2048,1441,2156,1632,2145,1631,2282,1789,2268,1790,2293,1850,2295,1863,2071,1941,2063,1939,1971,2067,1957,2067,1951,2212,1943,2221,1850,2312,1857,2327,1647,2431,1654,2443,1440,2546,1434,2547,1453,2727,1453,2734,1295,2699,1297,2699,1269,2563,1268,2557,1186,2322,1193,2324,1118,2264,1120,2265,1045,2170,1045">
    <!--[15] LYMA: Super Supplement-->
    <area href="/project-15/" class="project_link" onmouseenter="playMouseIn()" target="terminal_iframe" title="LYMA: Super Supplement" shape="poly" coords="3364,2557,3260,2554,3259,2684,3361,2685">
    <!--[14] Nike: Air Max Day-->
    <area href="/project-14/" class="project_link" onmouseenter="playMouseIn()" target="terminal_iframe" title="Nike: Air Max Day" shape="poly" coords="3010,1807,2813,1798,2802,2010,2814,2011,2816,1973,3003,1980">
    <!--[14] Nike: Air Max Day-->
    <area href="/project-14/" class="project_link" onmouseenter="playMouseIn()" target="terminal_iframe" title="Nike: Air Max Day" shape="poly"
      coords="2942,1277,2919,1565,2724,1551,2734,1295,2700,1296,2698,1269,2566,1266,2560,1184,2503,1186,2502,1169,2653,1172,2656,1051,2704,1051,2706,992,2722,991,2701,807,2894,801,2910,1008,2887,1009,2887,1028,2900,1029,2900,1276">
    <!--[14] Nike: Air Max Day-->
    <area href="/project-14/" class="project_link" onmouseenter="playMouseIn()" target="terminal_iframe" title="Nike: Air Max Day" shape="poly"
      coords="3391,1018,3355,1016,3352,1034,3193,1031,3192,1203,3109,1205,3113,1307,3073,1306,3074,1624,3270,1630,3268,1861,3282,1861,3275,2008,3388,2000,3392,2027,3612,2032,3613,1852,3562,1850,3561,1844,3542,1844,3540,1632,3559,1632,3560,1599,3330,1578,3349,1310,3331,1307,3327,1238,3388,1236,3389,1019">
    <!--[13] Nike: Alpha Menace Elite-->
    <area href="/project-13/" class="project_link" onmouseenter="playMouseIn()" target="terminal_iframe" title="Nike: Alpha Menace" shape="poly"
      coords="3963,1866,3614,1863,3613,2030,3391,2029,3388,1999,3150,2017,3153,1988,2816,1975,2807,2279,3138,2292,3154,2291,3160,2437,3329,2434,3325,2280,3388,2277,3392,2364,3673,2362,3679,2459,4031,2450,4026,2372,4022,2372,4017,2183,4096,2182,4088,1911,3962,1909">
    <!--[12] Nike: Nike Football Program Typeface-->
    <area href="/project-12/" class="project_link" onmouseenter="playMouseIn()" target="terminal_iframe" title="Nike: Nike Football Program Typeface" shape="poly"
      coords="3934,940,3716,941,3713,1102,3728,1101,3727,1222,3837,1226,3826,1521,4114,1523,4117,1298,4323,1303,4330,1057,4240,1055,4241,1065,3932,1061">
    <!--[11] The Apostles Tapestry-->
    <area href="/project-11/" class="project_link" onmouseenter="playMouseIn()" target="terminal_iframe" title="The Apostles Tapestry" shape="poly"
      coords="1423,1651,1239,1646,1233,1749,1095,1736,1087,1849,919,1861,865,1875,872,1916,734,1915,736,1877,625,1870,590,2246,737,2254,744,2385,883,2370,880,2525,984,2535,1044,2527,1045,2570,1350,2538,1332,2336,1348,2336,1340,2164,1369,2162,1374,2048,1519,2044,1517,1814,1417,1815">
    <!--[10] Chanel: Nº5 Sculpture-->
    <area href="/project-10/" class="project_link" onmouseenter="playMouseIn()" target="terminal_iframe" title="Chanel: Nº5 Sculpture" shape="poly"
      coords="1276,1155,976,1143,976,1137,923,1136,924,960,721,956,716,1132,679,1132,676,1507,700,1506,696,1725,898,1731,897,1747,742,1746,736,1913,870,1917,863,1876,915,1864,915,1841,1083,1834,1094,1736,1164,1741,1160,1704,1235,1704,1237,1647,1332,1649,1336,1549,1373,1543,1381,1400,1280,1393">
    <!--[10] Chanel: Nº5 Sculpture-->
    <area href="/project-10/" class="project_link" onmouseenter="playMouseIn()" target="terminal_iframe" title="Chanel: Nº5 Sculpture" shape="poly"
      coords="4138,2701,3750,2689,3740,2683,3633,2669,3628,2687,3175,2682,3176,3079,3368,3098,3409,3121,3403,3246,3418,3246,3417,3278,3427,3285,3430,3354,3398,3356,3386,3495,4164,3542">
    <!--[09] Jordan Brand: Court Concept-->
    <area href="/project-08/" class="project_link" onmouseenter="playMouseIn()" target="terminal_iframe" title="Jordan Brand: Court Concept" shape="poly"
      coords="4221,537,3818,537,3824,397,3532,396,3524,684,3730,684,3727,792,3939,792,3933,1061,4240,1065,4248,847,4179,849,4177,796,4214,795">
    <!--[08] Nike: The Stands Cafe Identity-->
    <area href="/project-08/" class="project_link" onmouseenter="playMouseIn()" target="terminal_iframe" title="Nike: The Stands Cafe Identity" shape="poly" coords="3021,450,2735,455,2735,608,2705,607,2703,800,2990,800,2991,642,3024,639">
    <!--[07] Nike: Kobe X, The Art of Attack-->
    <area href="/project-07/" class="project_link" onmouseenter="playMouseIn()" target="terminal_iframe" title="Nike: Kobe X, The Art of Attack" shape="poly"
      coords="2614,2305,2745,2302,2753,2502,3090,2487,3079,2290,2808,2279,2803,2093,2511,2099,2508,2177,2483,2175,2491,2300,2469,2299,2468,2332,2279,2324,2277,2543,2612,2541">
    <!--[06] Nike: Global Label System-->
    <area href="/project-06/" class="project_link" onmouseenter="playMouseIn()" target="terminal_iframe" title="Nike: Global Label System" shape="poly" coords="2785,1883,2556,1883,2559,2097,2786,2090">
    <!--[05] Nike: Technology Logos-->
    <area href="/project-05/" class="project_link" onmouseenter="playMouseIn()" target="terminal_iframe" title="Nike: Technology Logos" shape="poly" coords="2759,1723,2494,1731,2501,1903,2556,1902,2555,1882,2766,1882">
    <!--[04] Calvin Harris: Identity-->
    <area href="/project-04/" class="project_link" onmouseenter="playMouseIn()" target="terminal_iframe" title="Calvin Harris: Identity" shape="poly" coords="3559,751,3357,761,3358,735,3336,736,3337,587,3527,589,3524,684,3563,684">
    <!--[03] Jordan Brand: Russell Westbrook Identity-->
    <area href="/project-03/" class="project_link" onmouseenter="playMouseIn()" target="terminal_iframe" title="Jordan Brand: Russell Westbrook Identity" shape="poly"
      coords="2262,1952,2068,1951,2070,1958,1940,1970,1936,2164,1992,2165,1991,2187,2020,2186,2016,2402,2268,2410,2282,2170,2253,2170">
    <!--[02] DC Shoes: Identity-->
    <area href="/project-02/" class="project_link" onmouseenter="playMouseIn()" target="terminal_iframe" title="DC Shoes: Identity" shape="poly"
      coords="3987,1533,3826,1530,3827,1561,3671,1557,3668,1635,3705,1635,3709,1847,3684,1848,3682,1865,3948,1867,3947,1729,3962,1730,3965,1633,3977,1632,3972,1542,3987,1542">
    <!--[01] Nike: Los Fearless-->
    <area href="/project-01/" class="project_link" onmouseenter="playMouseIn()" target="terminal_iframe" title="Nike: Los Fearless" shape="poly"
      coords="2040,611,2044,825,2135,825,2135,1018,1798,1020,1798,968,1614,957,1625,643,1847,657,1848,578,1890,570,1922,576,1940,569,1982,585,2006,580">
    <!--shop.headless.horse-->
    <area href="https://shop.headless.horse/" class="click_sound" onmouseenter="playMouseIn()" target="_blank" title="shop.headless.horse" shape="poly"
      coords="868,2693,969,2636,984,2634,994,2644,993,2656,981,2664,980,2688,1106,2678,1106,2669,1148,2660,1187,2644,1246,2635,1279,2624,1292,2649,1284,2659,1283,2669,1312,2666,1360,2682,1360,2999,921,3039,892,3065,878,3065,801,3048,740,3040,673,3046,654,3051,647,3025,712,2991,823,2914,841,2899,831,2843,836,2801,848,2752,862,2724,878,2705,892,2696,892,2691,866,2700">
  </map>

  <audio src="http://assets.headless.horse/audio/pad.wav?dl=0" id="backgroundpad" class="audiofile" loop="loop" type="audio/mpeg"></audio>
  <audio src="http://assets.headless.horse/audio/select.mp3?dl=0" id="projectclick" class="audiofile" type="audio/mpeg"></audio>
  <audio src="http://assets.headless.horse/audio/click.mp3?dl=0" id="linkclick" class="audiofile" type="audio/mpeg"></audio>
</body>

</html>

<style>
  html {
    -ms-overflow-style: none;
    scrollbar-width: none;
    text-rendering: optimizeLegibility;
  }

  html::-webkit-scrollbar {
    display: none;
  }

  body {
    padding: 0px;
    margin: 0px;
    color: #999999;
    font-family: courier, monospace;
    font-size: 12px;
    font-style: normal;
    font-weight: 400;
  }

  p {
    color: #999999;
    font-family: courier, monospace;
    font-size: 12px;
    font-style: normal;
    font-weight: 400;
  }

  a {
    color: #999999;
    font-family: courier, monospace;
    font-size: 12px;
    font-style: normal;
    font-weight: 400;
  }

  a:link,
  a:visited {
    color: #999999;
    text-decoration: none;
  }

  a:hover,
  a:focus {
    color: #999999;
  }

  #loader {
    position: fixed;
    z-index: 10;
    top: 0;
    bottom: 0;
    width: 100%;
    height: 100%;
    background: #000000;
    line-height: 50px;
  }

  #loader_frame,
  #loader_percentage {
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    max-width: 40vw;
    height: 7px;
    border: 1px solid #999999;
    margin: auto;
  }

  #loader_bar {
    position: absolute;
    top: 0;
    left: 0;
    overflow: hidden;
    width: 0%;
    height: 100%;
    background: #999999;
  }

  #nav_bottom {
    position: fixed;
    z-index: 8;
    bottom: 0;
    overflow: hidden;
    width: 100%;
    padding: 0;
    border-top: 1px solid #999999;
    margin: 0;
    background: rgba(0, 0, 0, 0.6);
    -webkit-backdrop-filter: blur(6px);
    list-style-type: none;
  }

  #nav_bottom>li {
    padding: 5px 11px 5px 8px;
    float: left;
  }

  #notice_list a:hover::before {
    content: '● ';
  }

  #clock {
    cursor: default !important;
  }

  .nav_link {
    border-right: 1px solid #999999;
    cursor: pointer !important;
  }

  #terminal {
    position: fixed;
    z-index: 5;
    transform: translate(-50%, -50%);
    top: 50%;
    left: 50%;
    border: 1px solid #999999;
    background: rgba(0, 0, 0, 0.6);
    -webkit-backdrop-filter: blur(6px);
  }

  #terminal_container {
    width: 75vw;
  }

  #terminal_close {
    position: absolute;
    z-index: 4;
    top: 0;
    right: 0;
    width: 26px;
    height: 26px;
    cursor: pointer !important;
  }

  #terminal_button {
    position: absolute;
    z-index: 3;
    top: 0px;
    right: -1px;
    width: 26px;
    height: 26px;
    padding-top: 0px;
    border: 1px solid #999999;
    margin-top: -1px;
    background: rgba(0, 0, 0, 0.0);
    color: #999999;
    cursor: pointer !important;
  }

  #terminal_title {
    position: relative;
    z-index: 2;
    padding: 5px 10px;
    border-bottom: 1px solid #999999;
    margin: 0;
    cursor: grab !important;
  }

  #terminal_iframe {
    position: absolute;
    z-index: 7;
    width: 100%;
    height: calc(100% - 25px);
  }

  #terminal_content_frame {
    z-index: 6;
    overflow-x: auto;
    width: 50%;
    height: 70vh;
    padding: 10px 20px;
  }

  #command {
    display: block;
  }

  input[type="text"] {
    border: none;
    background: 0;
    color: #999999;
    font-family: courier, monospace;
    font-size: 12px;
    text-transform: lowercase;
  }

  input[type="text"]:focus {
    outline: none;
  }

  section {
    display: none;
  }

  #terminal_content a {
    padding: 0;
    margin: 0;
    line-height: 10px;
  }

  #terminal_content a:hover::before {
    content: '● ';
  }

  .open {
    display: block;
  }

  #emailform {
    display: none;
  }

  #img_cover {
    position: fixed;
    z-index: 1;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
  }

  img.map,
  map area {
    outline: none;
  }

  #tooltip {
    top: 100%;
    padding: 15px 20px;
    border: 1px solid #999999;
    margin-top: 15px;
    background: rgba(0, 0, 0, 0.6);
    -webkit-backdrop-filter: blur(6px);
  }

  #tooltip:after {
    content: ' →';
  }

  ::selection {
    background: #999999;
    color: #000000;
  }

  ::-moz-selection {
    background: #999999;
    color: #000000;
  }

  @media screen and (max-width: 900px) {
    body {
      font-size: 10px;
    }

    p {
      font-size: 10px;
    }

    p+p {
      margin-top: 10px
    }

    a {
      font-size: 10px;
    }

    #loader {
      line-height: 47px;
    }

    #loader_frame,
    #loader_percentage {
      max-width: 70vw;
      height: 7px;
    }

    #nav_bottom {
      z-index: 8;
      top: 0px;
      height: 26px;
      border-top: 0px;
      background: 0;
      -webkit-backdrop-filter: none;
    }

    .nav_link {
      display: none;
    }

    #notice_list {
      display: none;
    }

    #terminal {
      width: 100%;
      height: 100%;
      border: 0px;
      -webkit-backdrop-filter: none;
    }

    #terminal_container {
      width: 100%;
      height: 100%;
    }

    #terminal_button {
      display: none;
    }

    #terminal_content_frame {
      z-index: 6;
      overflow-x: hidden;
      padding: 5px 10px;
      width: calc(100% - 20px);
      height: 100%;
    }

    #command {
      width: 100vw;
    }

    input[type="text"] {
      transform: scale(0.60);
      margin-left: -40px;
      font-size: 16px;
    }

    #img_cover {
      display: none;
      background: rgba(0, 0, 0, 0.6);
    }

    #img {
      scrollbar-width: none;
      touch-action: manipulation;
    }

    #tooltip {
      display: none;
    }
  }
</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.0/TweenMax.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/luxon/2.1.1/luxon.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-dateFormat/1.0/jquery.dateFormat.js"></script>

<script>
/***************************************** AUDIO *****************************************/

  // audio pad
  window.onload = function() {
    document.getElementById("backgroundpad").play();
  }

  $(document).ready(function() {
    $("#backgroundpad")[0].volume = 0;
    $("#backgroundpad").animate({
      volume: 0.2
    }, 20000);
  });

  // audio project
  var s = document.getElementById("projectclick");
  $('.project_link').click(() => s.play());

  // audio link
  var a = document.getElementById("linkclick");
  $('.click_sound').click(() => a.play());
</script>

<script>
/***************************************** LOADER *****************************************/

  width = 100,
    perfData = window.performance.timing,
    EstimatedTime = -(perfData.loadEventEnd - perfData.navigationStart),
    time = parseInt((EstimatedTime / 1000) % 60) * 100 + 6000;

  $("#loader_bar").animate({
    width: width + "%"
  }, time);

  var loader_percentageID = $("#loader_percentage"),
    start = 0,
    end = 100,
    durataion = time;
  animateValue(loader_percentageID, start, end, durataion);

  function animateValue(id, start, end, duration) {

    var range = end - start,
      current = start,
      increment = end > start ? 1 : -1,
      stepTime = Math.abs(Math.floor(duration / range)),
      obj = $(id);

    var timer = setInterval(function() {
      current += increment;
      $(obj).text(current + "% https://headless.horse/");
      // obj.innerHTML = current;
      if (current == end) {
        clearInterval(timer);
      }
    }, stepTime);
  }

  setTimeout(function() {
    $('#loader_frame, #loader_percentage').delay(1000).fadeOut(1000);
    $('#loader').delay(2000).fadeOut(2000);
  }, time);

  $(document).ready(function() {
    $("#terminal_content").fadeIn(1000);
    $("#terminal_iframe").hide();
    $("#img_cover").show();
  });

  $(document).ready(function() {
    $(".terminal_close, #img_cover").click(function() {
      $("#terminal").fadeOut(1000);
      $("#terminal_iframe").hide();
      $("#terminal_content").fadeOut(1000);
      $("#img_cover").fadeOut(2000);
    });

    $(".project_link, .nav_link").click(function() {
      $("#terminal").fadeToggle(1000);
      $("#img_cover").fadeToggle(2000);
    });

    $(".project_link").click(function() {
      $("#terminal_iframe").show();
    });

    $(".nav_link").click(function() {
      $("#terminal_content").show();
      $('#commandinput[type="text"]').focus();
      $('#commandinput[type="text"]').val('');
    });
  });

  function clearframe() {
    document.getElementById("terminal_iframe").src = "about:blank";
  }

/***************************************** TIME *****************************************/

	const locations = document.querySelectorAll("#clock")

	setInterval(function() {
		// for each output tag
		locations.forEach(location => {

			// https://en.wikipedia.org/wiki/List_of_tz_database_time_zones
			const tz = location.getAttribute("data-tz")

			// get the time in that timezone
			const now = luxon.DateTime.now().setZone(tz)

			// hour in 24-hour time, no padding
			const hour = parseInt(now.toFormat("H"), 10)
			console.log(hour)

      // day of the week as number (Monday is 1, Sunday is 7)
			const hourday = now.toFormat("c")
			console.log(hourday)

      // day of the week 'Wednesday'
      const dayofweek = now.toFormat("cccc")
      console.log(dayofweek)

      // timezone 'GMT'
      const timezone = now.toFormat("ZZZZ")
      console.log(timezone)

      // time with timezone '00:00:00 GMT'
      const timeandtimezone = now.toFormat("HH:mm:ss ZZZZ")
      console.log(timeandtimezone)

/***************************************** CLOCK *****************************************/

			if (hour >= 8 && hour < 18 && hourday >= 1 && hourday < 6) {
				document.getElementById('clock').innerHTML = timeandtimezone + " Online";
			} else {
				document.getElementById('clock').innerHTML = timeandtimezone + " Offline";
			}

/***************************************** OPEN HOURS *****************************************/

			if (hour >= 8 && hour < 18 && hourday >= 1 && hourday < 6) {
				document.getElementById('hours_list').innerHTML = "Open. " + dayofweek + " business hours: 08:00 – 18:00 " + timezone + ".";
			} else {
				document.getElementById('hours_list').innerHTML = "Closed. " + dayofweek + ", we are open Monday - Friday: 08:00 – 18:00 " + timezone + ".";
			}
		})
	}, 1000)

/***************************************** IMAGE MOVER *****************************************/

function detectmob() {
   if(window.innerWidth <= 800 && window.innerHeight <= 600) {
     return true;
   } else {
     return false;
   }
}

if(!detectmob()){
  // acceleration value between 0 and 1 smaller values = smoother motion
  var acceleration = 0.02;

  var img = {
    element: document.querySelector("#img"),
    xMax: 0,
    yMax: 0,
    x: 0,
    y: 0
  };

  var mouse = {
    x: 0,
    y: 0
  };

  var vw = 0;
  var vh = 0;

  function init() {
    resize();
    TweenLite.set(img.element, {
      x: 0,
      y: 0
    });

    var pos = img.element._gsTransform;

    TweenMax.to(img.element, 1000, {
      x: 0,
      y: 0,
      repeat: -1,
      ease: Linear.easeNone,
      modifiers: {
        x: function() {
          img.x = map(mouse.x, 0, vw, 0, img.xMax);
          return pos.x + (img.x - pos.x) * acceleration;
        },
        y: function() {
          img.y = map(mouse.y, 0, vh, 0, img.yMax);
          return pos.y + (img.y - pos.y) * acceleration;
        }
      }
    });

    window.addEventListener("mousemove", moveAction);
    window.addEventListener("touchmove", moveAction);
    window.addEventListener("resize", resize);
  }

  /**
   * @param {number} x value to map
   * @param {number} a source min value
   * @param {number} b source max value
   * @param {number} c destination min value
   * @param {number} d destination max value
   */
  function map(x, a, b, c, d) {
    return c + (d - c) * ((x - a) / (b - a)) || 0;
  }

  function resize() {

    vw = window.innerWidth;
    vh = window.innerHeight;

    img.xMax = vw - img.element.naturalWidth;
    img.yMax = vh - img.element.naturalHeight;
  }

  function moveAction(event) {

    if (event.targetTouches && event.targetTouches[0]) {
      event.preventDefault();
      mouse.x = event.targetTouches[0].clientX;
      mouse.y = event.targetTouches[0].clientY;
    } else {
      mouse.x = event.clientX;
      mouse.y = event.clientY;
    }
  }
}

/***************************************** GREENSOCK MODIFIERS PLUGIN *****************************************/

var _gsScope = (typeof(module) !== "undefined" && module.exports && typeof(global) !== "undefined") ? global : this || window; //helps ensure compatibility with AMD/RequireJS and CommonJS/Node
(_gsScope._gsQueue || (_gsScope._gsQueue = [])).push( function() {

	"use strict";

		var _cssRatioSetter = function(pt, cssp, mod) { //Takes an individual CSSPropTween and converts it into a type:2 that has a setRatio that does everything the regular CSSPlugin.setRatio() method does but applying the mod() too. We do this to keep the main CSSPlugin.setRatio() as fast as possible (the vast majority of times, no mod() will be necessary)
				var type = pt.type,
					oldSetRatio = pt.setRatio,
					tween = cssp._tween,
					target = cssp._target;
				pt.type = 2;
				pt.m = mod;
				pt.setRatio = function(v) {
					var min = 0.000001,
						val, str, i;
					if (v === 1 && (tween._time === tween._duration || tween._time === 0)) {

						if (type !== 2) {
							if (pt.r && type !== -1) {
								val = Math.round(pt.s + pt.c);
								if (!type) {
									pt.t[pt.p] = mod.call(tween, val + pt.xs0, target, tween);
								} else if (type === 1) {
									str = pt.xs0 + val + pt.xs1;
									for (i = 1; i < pt.l; i++) {
										str += pt["xn"+i] + pt["xs"+(i+1)];
									}
									pt.t[pt.p] = mod.call(tween, str, target, tween);
								}
							} else {
								pt.t[pt.p] = mod.call(tween, pt.e, target, tween);
							}
						} else {
							oldSetRatio.call(pt, v);
						}

					} else if (v || !(tween._time === tween._duration || tween._time === 0) || tween._rawPrevTime === -0.000001) {
						val = pt.c * v + pt.s;
						if (pt.r) {
							val = Math.round(val);
						} else if (val < min) if (val > -min) {
							val = 0;
						}
						if (!type) {
							pt.t[pt.p] = mod.call(tween, val + pt.xs0, target, tween);
						} else if (type === 1) {
							str = pt.xs0 + val + pt.xs1;
							for (i = 1; i < pt.l; i++) {
								str += pt["xn"+i] + pt["xs"+(i+1)];
							}
							pt.t[pt.p] = mod.call(tween, str, target, tween);

						} else if (type === -1) { //non-tweening value
							pt.t[pt.p] = mod.call(tween, pt.xs0, target, tween);

						} else if (oldSetRatio) {
							oldSetRatio.call(pt, v);
						}

					} else {
						if (type !== 2) {
							pt.t[pt.p] = mod.call(tween, pt.b, target, tween);
						} else {
							oldSetRatio.call(pt, v);
						}
					}
				};
			},
			_modCSS = function(lookup, cssp) {
				var pt = cssp._firstPT,
					hasBezier = (lookup.rotation && cssp._overwriteProps.join("").indexOf("bezier") !== -1); //when a Bezier tween is applying autoRotation, it's a very special case we need to handle differently.
				if (lookup.scale) {
					lookup.scaleX = lookup.scaleY = lookup.scale;
				} else if (lookup.rotationZ) {
					lookup.rotation = lookup.rotationZ;
				}
				while (pt) {
					if (typeof(lookup[pt.p]) === "function") {
						_cssRatioSetter(pt, cssp, lookup[pt.p]);
					} else if (hasBezier && pt.n === "bezier" && pt.plugin._overwriteProps.join("").indexOf("rotation") !== -1) {
						pt.data.mod = lookup.rotation;
					}
					pt = pt._next;
				}
			},

			ModifiersPlugin = _gsScope._gsDefine.plugin({
				propName: "modifiers",
				version: "0.0.4",
				API: 2,

				//called when the tween renders for the first time. This is where initial values should be recorded and any setup routines should run.
				init: function(target, value, tween) {
					this._tween = tween;
					this._vars = value;
					return true;
				},

				initAll: function() {
					var tween = this._tween,
						lookup = this._vars,
						mpt = this,
						pt = tween._firstPT,
						val, next;
					//initAll() gets called for each and every ModifiersPlugin instance in a tween, so if there are multiple targets, there will be multiple instances. Since we're ripping through the whole tween (and all the PropTweens), we only need to run this code ONCE. So we're setting a toggle on the first PropTween that just tells us if we've done it already. We don't set it on the tween instance because if it gets invalidated, we don't want to have to track this property and reset it. PropTweens get blown away when a tween is invalidated.
					if (pt._modInitted) {
						return false;
					} else {
						pt._modInitted = 1;
					}
					while (pt) {
						next = pt._next; //record here, because it may get removed
						val = lookup[pt.n];
						if (pt.pg) {
							if (pt.t._propName === "css") { //handle CSSPlugin uniquely (for performance, due to the fact that the values almost always are a concatenation of numbers and strings, like suffixes, and we don't want to slow down the regular CSSPlugin setRatio() performance with conditional checks for if the value needs to be modded, so we pull any modding prop out and change it to a type:2 one that simply calls a setRatio() method where we encapsulate the modding and update all together. That way, it says in the main CSSProp linked list and just has some custom logic applied to it inside its setRatio())
								_modCSS(lookup, pt.t);
							} else if (pt.t !== mpt) { //don't run modProps on modProps :)
								val = lookup[pt.t._propName];
								pt.t._tween = tween;
								pt.t._mod((typeof(val) === "object") ? val : lookup);
							}
						} else if (typeof(val) === "function") {
							if (pt.f === 2 && pt.t) { //a blob (text containing multiple numeric values)
								pt.t._applyPT.m = val;
								pt.t._tween = tween;
							} else {
								this._add(pt.t, pt.p, pt.s, pt.c, val);
								//remove from linked list
								if (next) {
									next._prev = pt._prev;
								}
								if (pt._prev) {
									pt._prev._next = next;
								} else if (tween._firstPT === pt) {
									tween._firstPT = next;
								}
								pt._next = pt._prev = null;
								tween._propLookup[pt.n] = mpt;
							}
						}
						pt = next;
					}
					return false;
				}

			}),
			p = ModifiersPlugin.prototype;

		p._add = function(target, p, s, c, mod) {
			this._addTween(target, p, s, s + c, p, mod);
			this._overwriteProps.push(p);
		};

	p = _gsScope._gsDefine.globals.TweenLite.version.split(".");
	if (Number(p[0]) <= 1 && Number(p[1]) < 19 && _gsScope.console) {
		console.log("ModifiersPlugin requires GSAP 1.19.0 or later.");
	}


}); if (_gsScope._gsDefine) { _gsScope._gsQueue.pop()(); }

//export to AMD/RequireJS and CommonJS/Node (precursor to full modular build system coming at a later date)
(function(name) {
	"use strict";
	var getGlobal = function() {
		return (_gsScope.GreenSockGlobals || _gsScope)[name];
	};
	if (typeof(module) !== "undefined" && module.exports) { //node
		require("../TweenLite.js");
		module.exports = getGlobal();
	} else if (typeof(define) === "function" && define.amd) { //AMD
		define(["TweenLite"], getGlobal);
	}
}("ModifiersPlugin"));

/***************************************** TOOLTIP + TITLES *****************************************/

  window.addEventListener("load", init);

  (function() {
    var ID = "tooltip",
      CLS_ON = "tooltip_ON",
      FOLLOW = true,
      DATA = "_tooltip",
      OFFSET_X = 20,
      OFFSET_Y = 10,
      showAt = function(e) {
        var ntop = e.pageY + OFFSET_Y,
          nleft = e.pageX + OFFSET_X;
        $("#" + ID).html($(e.target).data(DATA)).css({
          position: "absolute",
          top: ntop,
          left: nleft
        }).show();
      };

    $(document).on("mouseenter", "*[title]", function(e) {
      $(this).data(DATA, $(this).attr("title"));
      $(this).removeAttr("title").addClass(CLS_ON);
      $("<div id='" + ID + "' />").appendTo("body");
      showAt(e);
    });
    $(document).on("mouseleave", "." + CLS_ON, function(e) {
      $(this).attr("title", $(this).data(DATA)).removeClass(CLS_ON);
      $("#" + ID).remove();
    });
    if (FOLLOW) {
      $(document).on("mousemove", "." + CLS_ON, showAt);
    }
  }());

  // 'alt' of link to '#terminal_title'
  $('.project_link, .nav_link').click(function() {
    let TermTitle = $(this).attr('alt');
    $('#terminal_title').html(TermTitle);

  });

  // makes 'alt' class == 'title' class
  $('.project_link, .nav_link').hover(function() {
    $this = $(this);
    if (!$this.attr('alt') && $this.attr('title')) {
      $this.attr('alt', $this.attr('title'));
    }
  })

/***************************************** DRAGGABLE *****************************************/

  var selected = null,
    x_pos = 0,
    y_pos = 0,
    x_elem = 0,
    y_elem = 0;

  function _drag_init(elem) {
    selected = elem;
    x_elem = x_pos - selected.offsetLeft;
    y_elem = y_pos - selected.offsetTop;
  }

  function _move_elem(e) {
    x_pos = document.all ? window.event.clientX : e.pageX;
    y_pos = document.all ? window.event.clientY : e.pageY;
    if (selected !== null) {
      selected.style.left = (x_pos - x_elem) + 'px';
      selected.style.top = (y_pos - y_elem) + 'px';
    }
  }

  function _destroy() {
    selected = null;
  }

  document.getElementById('terminal_title').onmousedown = function() {
    _drag_init(terminal);
    return false;
  };
  document.onmousemove = _move_elem;
  document.onmouseup = _destroy;
</script>

<script type="module">
/***************************************** NOTICE *****************************************/

  import { html, render } from 'https://unpkg.com/lit?module';

  const URL = "https://notion-api.splitbee.io/v1/page/f97f1af964fe48989650aae62609bf37";

  const handleAsJson = response => response.json();

  const trace = tag => x => {
    console.log(tag, x);
    return x;
  }

  function renderText(node) {
    if (node.length === 1)
      return node[0];

    const [content, [[tagName, attr]]] = node;
    if (tagName === 'a') {
      return html`
        <a href="${attr}" target="_blank">${content} →</a>
      `;
    }
    else return node;
  }

  async function run() {

    const result = await fetch(URL).then(handleAsJson)

    const page = Object.values(result).find(x => x.value.type === 'page');

    const blocks = page.value.content.map(id => result[id].value);

console.log(blocks.map(x => x.type))

const content = blocks.map(block => {
  switch (block.type) {
    case 'text':
      if (!block.properties) return '';
      else {
        return html`<span>${block.properties.title.map(renderText)}</span>`;
      }
      default:
        return block.title;
  }
  });

  render(content, document.getElementById('notice_list'))
}
run();
</script>

<script type="module">
/***************************************** INFO *****************************************/

  import { html, render } from 'https://unpkg.com/lit?module';

  const URL = "https://notion-api.splitbee.io/v1/page/a1f6fd4a910349c0ad29c9d8ee428780";

  const handleAsJson = response => response.json();

  const trace = tag => x => {
    console.log(tag, x);
    return x;
  }

  function renderText(node) {
    if (node.length === 1)
      return node[0];

    const [content, [[tagName, attr]]] = node;
    if (tagName === 'a') {
      return html`
        <a href="${attr}" target="_blank">${content}</a>
      `;
    }
    else return node;
  }

  async function run() {

    const result = await fetch(URL).then(handleAsJson)

    const page = Object.values(result).find(x => x.value.type === 'page');

    const blocks = page.value.content.map(id => result[id].value);

console.log(blocks.map(x => x.type))

  const content = blocks.map(block => {
    switch (block.type) {
      case 'sub_header':
        return html`<p style="text-transform: uppercase;">${block.properties.title}</p>`;
      case 'divider':
        return html`<br>`;
      case 'text':
        if (!block.properties) return '';
        else {
          return html`<p>${block.properties.title.map(renderText)}</p>`;
        }
        default:
          return block.title;
    }
  });

  render(content, document.getElementById('info_list'))
}
run();
</script>

<script type="module">
/***************************************** PROJECTS *****************************************/

  import { html, render } from 'https://unpkg.com/lit?module';

  const URL = "https://notion-api.splitbee.io/v1/table/40ee05b104644055b139eefafd9ae800";

  const handleAsJson = response => response.json();

  const trace = tag => x => {
    console.log(tag, x);
    return x;
  }

  const tableTemplate = table => html`
      ${table.map(({id, Client, Project, Number, Status}) => html`
        <p><a href="/project-${Number}" target="terminal_iframe">${Number}. ${Client} – ${Project}. ${Status}</a></p>
      `)}
  `;

  const projectItem = fetch(URL)
    .then(handleAsJson) // Promise<TableJson>
    .then(trace('table is'))
    .then(tableTemplate) // Promise<TemplateResult>
		.then(trace('template result is'))
    .then(result =>
			render(result, document.getElementById('project_list')))
</script>

<script type="module">
/***************************************** CONTACT *****************************************/

  import { html, render } from 'https://unpkg.com/lit?module';

  const URL = "https://notion-api.splitbee.io/v1/page/483f6b9565e246b4aaedafdf98483e5d";

  const handleAsJson = response => response.json();

  const trace = tag => x => {
    console.log(tag, x);
    return x;
  }

  function renderText(node) {
    if (node.length === 1)
      return node[0];

    const [content, [[tagName, attr]]] = node;
    if (tagName === 'a') {
      return html`
        <a href="${attr}" target="_blank">${content}</a>
      `;
    }
    else return node;
  }

  async function run() {

    const result = await fetch(URL).then(handleAsJson)

    const page = Object.values(result).find(x => x.value.type === 'page');

    const blocks = page.value.content.map(id => result[id].value);

console.log(blocks.map(x => x.type))

  const content = blocks.map(block => {
    switch (block.type) {
      case 'sub_header':
        return html`<p style="text-transform: uppercase;">${block.properties.title}</p>`;
      case 'divider':
        return html`<br>`;
      case 'text':
        if (!block.properties) return '';
        else {
          return html`<p>${block.properties.title.map(renderText)}</p>`;
        }
        default:
          return block.title;
    }
  });

  render(content, document.getElementById('contact_list'))
}
run();
</script>

<script type="module">
/***************************************** FOLLOW *****************************************/

  import { html, render } from 'https://unpkg.com/lit?module';

  const URL = "https://notion-api.splitbee.io/v1/table/b8c10ba180b64ad59d1e88e954592822";

  const handleAsJson = response => response.json();

  const trace = tag => x => {
    console.log(tag, x);
    return x;
  }

  const tableTemplate = table => html`
      ${table.map(({Site, Handle, Slug}) => html`
        <p><a href="${Slug}${Handle}/" target="_blank">${Site} →</a></p>
      `)}
  `;

  const projectItem = fetch(URL)
    .then(handleAsJson) // Promise<TableJson>
    .then(trace('table is'))
    .then(tableTemplate) // Promise<TemplateResult>
		.then(trace('template result is'))
    .then(result =>
			render(result, document.getElementById('follow_list')))
</script>

<script type="module">
/***************************************** PRESS *****************************************/

  import { html, render } from 'https://unpkg.com/lit?module';

  const URL = "https://notion-api.splitbee.io/v1/table/cd48ac8833464607818ff47ee43fb791";

  const handleAsJson = response => response.json();

  const trace = tag => x => {
    console.log(tag, x);
    return x;
  }

  const tableTemplate = table => html`
      ${table.map(({id, Recognition, Outlet, Project, Published, Status, Slug}) => html`
        <p><a href="${Slug}" target="_blank">${Published} ${Recognition}, ${Outlet} – ${Project}. ${Status}</a></p>
      `)}
  `;

  const pressItem = fetch(URL)
    .then(handleAsJson) // Promise<TableJson>
    .then(trace('table is'))
    .then(tableTemplate) // Promise<TemplateResult>
		.then(trace('template result is'))
    .then(result =>
			render(result, document.getElementById('press_list')))
</script>

<script>
/***************************************** SHOP *****************************************/

  $(document).on("keypress", "input", function(e) {
    if (e.which == 13) {
      var inputVal = $(this).val();
      if (inputVal == "shop") {
        setTimeout(function(e) {
          window.open('https://shop.headless.horse/', '_blank');
        }, 1000);
      }
    }
  });
</script>

<script type="module">
/***************************************** LAB *****************************************/

  import { html, render } from 'https://unpkg.com/lit?module';

  const URL = "https://notion-api.splitbee.io/v1/table/2b84e2ba26354d04a6512d42d42ca711";

  const handleAsJson = response => response.json();

  const trace = tag => x => {
    console.log(tag, x);
    return x;
  }

  const tableTemplate = table => html`
      ${table.map(({Project, Published, Status, Slug}) => html`
        <p><a href="${Slug}" target="_blank">${Published} ${Project}. ${Status}</a></p>
      `)}
  `;

  const projectItem = fetch(URL)
    .then(handleAsJson) // Promise<TableJson>
    .then(trace('table is'))
    .then(tableTemplate) // Promise<TemplateResult>
		.then(trace('template result is'))
    .then(result =>
			render(result, document.getElementById('lab_list')))
</script>

<script>
/***************************************** MAILINGLIST *****************************************/

  function showError(el, err) {
    $("#mc-embedded-subscribe").attr("disabled", false);
    $('#validate_message').html("Valid: press the enter key to subscribe.");
    if (err) {
      $("#mc-embedded-subscribe").attr("disabled", true)
      $('#validate_message').html("Error: please input a valid email address.");
    }
  }

  var isValidEmailAddress = function(emailAddress) {
    var pattern = new RegExp( // regexes validate email
      /^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i
    );
    return pattern.test(emailAddress);
  };

  function validate_email(el, val) {
    var err = !isValidEmailAddress(val);
    showError(el, err);
  }

  $('#commandinput').on('keyup', function() {
    validate_email(this, this.value);
    $('#mce-EMAIL').val($(this).val()); // clone input val to hidden email address input
  });

  $(function() {
    $(document).keydown(function(e) {
      switch (e.which) {
        case 13: // down key "Enter"
          $('#commandinput[type="text"]').focus();
          $("#mc-embedded-subscribe").trigger("click") // trigger hidden form submission
          break;
      }
    });
  });
</script>

<script>
/***************************************** PRIVATE LOGIN *****************************************/

(function() {
  var textArea = document.getElementById("commandinput");

  textArea.addEventListener("keydown", function(e) {
    if (e.keyCode === 13) {
      doclientSearch(textArea);
    }
  });
})();

function doclientSearch(textArea) {
	var value = textArea.value;

  if (value.match(/^([\w\-]+)/)[1].toLowerCase() === "uname") {

    window.open('https://dev.headless.horse/' + value.match('uname(.*)')[1].trim());
  }
}
</script>

<script type="module">
/***************************************** JOBS *****************************************/

  import { html, render } from 'https://unpkg.com/lit?module';

  const URL = "https://notion-api.splitbee.io/v1/table/c87900ce8abc4ed28c77222beebebeac";

  const handleAsJson = response => response.json();

  const trace = tag => x => {
    console.log(tag, x);
    return x;
  }

  const tableTemplate = table => html`
      ${table.map(({id, Status, Location, Job, Contract, Close, Slug}) => html`
        <p><a href="${Slug}" target="_blank">${Location}, ${Job}, ${Contract} – ${Status}.</a></p>
      `)}
  `;

  const projectItem = fetch(URL)
    .then(handleAsJson) // Promise<TableJson>
    .then(trace('table is'))
    .then(tableTemplate) // Promise<TemplateResult>
		.then(trace('template result is'))
    .then(result =>
			render(result, document.getElementById('job_list')))
</script>

<script type="module">
/***************************************** IMPRINT *****************************************/

  import { html, render } from 'https://unpkg.com/lit?module';

  const URL = "https://notion-api.splitbee.io/v1/page/314869ae00f14b728bd642c732f70915";

  const handleAsJson = response => response.json();

  const trace = tag => x => {
    console.log(tag, x);
    return x;
  }

  function renderText(node) {
    if (node.length === 1)
      return node[0];

    const [content, [[tagName, attr]]] = node;
    if (tagName === 'a') {
      return html`
        <a href="${attr}" target="_blank">${content}</a>
      `;
    }
    else return node;
  }

  async function run() {

    const result = await fetch(URL).then(handleAsJson)

    const page = Object.values(result).find(x => x.value.type === 'page');

    const blocks = page.value.content.map(id => result[id].value);

console.log(blocks.map(x => x.type))

  const content = blocks.map(block => {
    switch (block.type) {
      case 'sub_header':
        return html`<p style="text-transform: uppercase;">${block.properties.title}</p>`;
      case 'divider':
        return html`<br>`;
      case 'text':
        if (!block.properties) return '';
        else {
          return html`<p>${block.properties.title.map(renderText)}</p>`;
        }
        default:
          return block.title;
    }
  });

  render(content, document.getElementById('imprint_list'))
}
run();
</script>

<script>
/***************************************** SHARE TWEET *****************************************/

  $(document).on("keypress", "input", function(e) {
    if (e.which == 13) {
      var inputVal = $(this).val();
      if (inputVal == "tweet") {
        setTimeout(function(e) {
          window.open('https://twitter.com/intent/tweet?url=headless.horse&text=@headless__horse', '_blank');
        }, 1000);
      }
    }
  });
</script>

<script>
/***************************************** SHARE LIKE *****************************************/

  $(document).on("keypress", "input", function(e) {
    if (e.which == 13) {
      var inputVal = $(this).val();
      if (inputVal == "like") {
        setTimeout(function(e) {
          window.open('https://www.facebook.com/sharer.php?href=https://headless.horse/', '_blank');
        }, 1000);
      }
    }
  });
</script>

<script>
/***************************************** SHARE EMAIL *****************************************/

  $(document).on("keypress", "input", function(e) {
    if (e.which == 13) {
      var inputVal = $(this).val();
      if (inputVal == "email") {
        setTimeout(function(e) {
          window.location.href = 'mailto:name@email.com?subject=Headless%20Horse&body=I%20thought%20you%20might%20like%20this:%20https://headless.horse/';
        }, 1000);
      }
    }
  });
</script>

<script>
/***************************************** TYPER *****************************************/

  (function(e) {
    "use strict";
    e.fn.textTyper = function(t) {
      var n = {
          typingClass: "typing",
          beforeAnimation: function() {},
          afterAnimation: function() {},
          speed: 70,
          nextLineDelay: 400,
          startsFrom: 0,
          repeatAnimation: false,
          repeatDelay: 4e3,
          repeatTimes: 1,
          cursorHtml: '<span class="cursor">|</span>'
        },
        r = e.extend({}, n, t);
      this.each(function() {
        var t = e(this),
          n = 1,
          i = "typingCursor";
        var s = t,
          o = s.length,
          u = [];
        while (o--) {
          u[o] = e.trim(e(s[o]).html());
          e(s[o]).html("")
        }
        t.init = function(e) {
          var n = r.beforeAnimation;
          if (n) n();
          t.animate(0)
        };
        t.animate = function(o) {
          var a = s[o],
            f = r.typingClass,
            l = r.startsFrom;
          e(a).addClass(f);
          var c = setInterval(function() {
            var f = r.cursorHtml;
            f = e("<div>").append(e(f).addClass(i)).html();
            e(a).html(u[o].substr(0, l) + f);
            l++;
            if (u[o].length < l) {
              clearInterval(c);
              o++;
              if (s[o]) {
                setTimeout(function() {
                  e(a).html(u[o - 1]);
                  t.animate(o)
                }, r.nextLineDelay)
              } else {
                e(a).find("." + i).remove();
                if (r.repeatAnimation && (r.repeatTimes == 0 || n < r.repeatTimes)) {
                  setTimeout(function() {
                    t.animate(0);
                    n++
                  }, r.repeatDelay)
                } else {
                  var h = r.afterAnimation;
                  if (h) h()
                }
              }
            }
          }, r.speed)
        };
        t.init()
      });
      return this
    }
  })(jQuery)
</script>

<script>
/***************************************** TERMINAL OPEN *****************************************/

  $('#terminal').click(function() {
    $('#commandinput[type="text"]').focus();
  });

  $(document).ready(function() {
    $('#command').hide();
    $('#commandinput[type="text"]').focus();
    $('#home').addClass('open');
    $('#home').textTyper({
      speed: 20,
      afterAnimation: function() {
        $('#command').fadeIn();
        $('#commandinput[type="text"]').focus();
        $('#commandinput[type="text"]').val('');
      }
    });

    // get array of section ids, that exist in DOM
    var sectionArray = [];
    $('section').each(function(i, e) {
      // you can use e.id instead of $(e).attr('id')
      sectionArray.push($(e).attr('id'));
    });

    // command input
    $('#commandinput[type="text"]').keyup(function(e) {

      if (e.which == 13) {

        $('#command').hide();
        var destination = $('input[type="text"]').val();

        // display section with id == destination
        $('section[id="' + destination + '"]').addClass('open').siblings().removeClass('open');

        // display error
        if ($.inArray(destination, sectionArray) == -1) {
          $('#error').addClass('open');
          $('#error').siblings().removeClass('open');
        }

        $('.open').textTyper({
          speed: 10,
          afterAnimation: function() {
            $('#command').fadeIn();
            $('#commandinput[type="text"]').focus();
            $('#commandinput[type="text"]').val('');
          }
        });
      } // end if 'enter' key pressed
    }); // end keyup function
  });
</script>

<script>
/***************************************** LAST VISITED *****************************************/

  var days = 730; // the cookie will expire = 2 years
  var lastvisit = new Object();

  lastvisit.getCookie = function(Name) {
    var re = new RegExp(Name + "=[^;]+", "i");
    if (document.cookie.match(re))
      return document.cookie.match(re)[0].split("=")[1];
    return '';
  }

  lastvisit.setCookie = function(name, value, days) {
    var expireDate = new Date();

    var expstring = expireDate.setDate(expireDate.getDate() + parseInt(days));
    document.cookie = name + "=" + value + "; expires=" + expireDate.toGMTString() + "; path=/";
  }

  lastvisit.showmessage = function() {
    var wh = new Date();
    if (lastvisit.getCookie("visit_record") == "") {
      lastvisit.setCookie("visit_record", wh, days);
      document.getElementById("firstuse_message").innerHTML = "Type 'list' to see a list of commands, or close the terminal to begin.";

    } else {
      var lv = lastvisit.getCookie("visit_record");
      var lvp = Date.parse(lv);
      var now = new Date();
      now.setTime(lvp);
      var month = new Array("01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12");
      var dd = now.getDate();
      if (dd < 10) {
        dd = "0" + dd
      }
      var mn = now.getMonth();
      mn = month[mn];
      yy = now.getFullYear();
      var hh = now.getHours();
      if (hh == 0) {
        hh = 12
      }
      if (hh < 10) {
        hh = "0" + hh
      };
      var mins = now.getMinutes();
      if (mins < 10) {
        mins = "0" + mins
      }
      var dispDate = dd + "." + mn + "." + yy + " at " + hh + ":" + mins
      document.getElementById("welcome_back").innerHTML = "back ";
      document.getElementById("lastvisit_message").innerHTML = "Your last visit was on " + dispDate + ".";
    }
    lastvisit.setCookie("visit_record", wh, days);

  }
  lastvisit.showmessage();
</script>

<div id="emailform">
  <form action="https://headlesshorse.us20.list-manage.com/subscribe/post?u=4792941058b6d3b4b6ea3b3f2&amp;id=6ac99d042c" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <input type="email" value="" name="EMAIL" id="mce-EMAIL"  class="emailform">
    <input type="submit" disabled="disabled" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
  </form>
</div>
